{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many customers do we have?"},{"role": "assistant","content": "-- A customer is defined as someone who has an account with a category starting with '1' (e.g., Current) or '6' (e.g., Savings), and should not have an account in category '1080' (e.g., Suspended Accounts).\nSELECT COUNT(DISTINCT c.CUSTOMER_NO)\nFROM CB_CUSTOMERS c\nJOIN CB_ACCOUNTS a\nON c.CUSTOMER_NO = a.CUSTOMER_NUMBER\nWHERE a.CATEGORY NOT IN ('1080', '1031')\nAND SUBSTRING(a.CATEGORY, 1, 1) IN ('1', '6');"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many accounts transacted yesterday?"},{"role": "assistant","content": "SELECT COUNT(DISTINCT ACCOUNT_NUMBER) AS account_count\nFROM CB_ACCOUNTS\nWHERE LAST_TRANSACTION_DATE = CAST(GETDATE() - 1 AS DATE);"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many active accounts do we have?"},{"role": "assistant","content": "SELECT COUNT(DISTINCT ACCOUNT_NUMBER)\nFROM CB_ACCOUNTS\nWHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -90, GETDATE()))\nOR (CATEGORY LIKE '6%' AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -360, GETDATE()) AND CATEGORY NOT IN ('1080', '1031'));"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many inactive accounts?"},{"role": "assistant", "content": "SELECT COUNT(DISTINCT ACCOUNT_NUMBER)\nFROM CB_ACCOUNTS\nWHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -90, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -180, GETDATE()))\nOR (CATEGORY LIKE '6%' AND LAST_TRANSACTION_DATE < DATEADD(DAY, -360, GETDATE()));"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many customers are in the retail segment?"},{"role": "assistant","content": "-- Segment '1' corresponds to Retail customers.\nSELECT COUNT(DISTINCT c.CUSTOMER_NO)\nFROM CB_CUSTOMERS c\nJOIN CB_ACCOUNTS a\nON c.CUSTOMER_NO = a.CUSTOMER_NUMBER\nWHERE c.SEGMENT = '1' AND a.CATEGORY NOT IN ('1080', '1031') AND SUBSTRING(a.CATEGORY, 1, 1) IN ('1', '6');"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many customers are in the SME segment?"},{"role":"assistant","content":"-- Segment '2' corresponds to SME (Small and Medium Enterprises) customers.\nSELECT COUNT(DISTINCT c.CUSTOMER_NO)\nFROM CB_CUSTOMERS c\nJOIN CB_ACCOUNTS a\nON c.CUSTOMER_NO = a.CUSTOMER_NUMBER\nWHERE c.SEGMENT = '2' AND a.CATEGORY NOT IN ('1080', '1031') AND SUBSTRING(a.CATEGORY, 1, 1) IN ('1', '6');"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many customers are in the corporate segment?"},{"role":"assistant","content":"-- Segment '4' corresponds to corporate customers.\nSELECT COUNT(DISTINCT c.CUSTOMER_NO)\nFROM CB_CUSTOMERS c\nJOIN CB_ACCOUNTS a\nON c.CUSTOMER_NO = a.CUSTOMER_NUMBER\nWHERE c.SEGMENT = '4' AND a.CATEGORY NOT IN ('1080', '1031') AND SUBSTRING(a.CATEGORY, 1, 1) IN ('1', '6');"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many Loan accounts?"},{"role":"assistant","content":"-- Categories starting with '3' correspond to loan accounts.\nSELECT COUNT(DISTINCT ACCOUNT_NUMBER)\nFROM CB_ACCOUNTS\nWHERE CATEGORY LIKE '3%';"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many Current accounts?"},{"role":"assistant","content":"-- Categories starting with '1' correspond to current accounts.\nSELECT COUNT(DISTINCT ACCOUNT_NUMBER)\nFROM CB_ACCOUNTS\nWHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031'));"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many Savings accounts?"},{"role":"assistant","content":"-- Categories starting with '6' correspond to savings accounts.\nSELECT COUNT(DISTINCT ACCOUNT_NUMBER)\nFROM CB_ACCOUNTS\nWHERE CATEGORY LIKE '6%';"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"Give me a list of 10 corporate customers names?"},{"role":"assistant","content":"-- Corporate customers are those in segment '4'.\nSELECT TOP 10 c.SHORT_NAME\nFROM CB_CUSTOMERS c\nJOIN CB_ACCOUNTS a\nON c.CUSTOMER_NO = a.CUSTOMER_NUMBER\nWHERE c.SEGMENT = '4' AND a.CATEGORY <> '1080' AND SUBSTRING(a.CATEGORY, 1, 1) IN ('1', '6');"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"Give me a list of all VIP customers?"},{"role":"assistant","content":"-- VIP customers have TARGET values of '57', '66', or '91'.\nSELECT *\nFROM CB_CUSTOMERS\nWHERE TARGET IN ('57', '66', '91');"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many staff members do we have?"},{"role":"assistant","content":"-- Staff members have a TARGET value of '1'.\nSELECT COUNT(DISTINCT CUSTOMER_NO)\nFROM CB_CUSTOMERS\nWHERE TARGET = '1';"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"Give a list of all targets to identify different customers?"},{"role":"assistant","content":"SELECT DISTINCT TARGET\nFROM CB_CUSTOMERS;"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many inactive customers do we have?"},{"role":"assistant","content":"-- Inactive Customer: A customer with no active accounts but possessing at least one inactive current or savings account.\nWITH Inactive_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -90, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -180, GETDATE())) OR (CATEGORY LIKE '6%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -360, GETDATE()))), Active_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -90, GETDATE())) OR (CATEGORY LIKE '6%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -360, GETDATE()))) SELECT COUNT(DISTINCT C.CUSTOMER_NO) AS Inactive_Customers FROM CB_CUSTOMERS C INNER JOIN Inactive_Accounts IA ON C.CUSTOMER_NO = IA.CUSTOMER_NUMBER LEFT JOIN Active_Accounts AA ON C.CUSTOMER_NO = AA.CUSTOMER_NUMBER WHERE AA.CUSTOMER_NUMBER IS NULL;"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"What is our churn rate number?"},{"role":"assistant","content":"-- Churn rate is calculated as the percentage of Dom Closed Customers.\nWITH Dom_Closed_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -360, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -1800, GETDATE())), Active_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -90, GETDATE())) OR (CATEGORY LIKE '6%' AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -360, GETDATE()))), Inactive_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -90, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -180, GETDATE())) OR (CATEGORY LIKE '6%' AND LAST_TRANSACTION_DATE < DATEADD(DAY, -360, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -720, GETDATE()))), Dormant_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -180, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -360, GETDATE())), Total_Customers AS (SELECT COUNT(DISTINCT c.CUSTOMER_NO) AS Total FROM CB_CUSTOMERS c JOIN CB_ACCOUNTS a ON c.CUSTOMER_NO = a.CUSTOMER_NUMBER WHERE a.CATEGORY NOT IN ('1080', '1031') AND SUBSTRING(a.CATEGORY, 1, 1) IN ('1', '6')) SELECT COUNT(DISTINCT C.CUSTOMER_NO) AS Dom_Closed_Customers, (SELECT Total FROM Total_Customers) AS Total_Customers, CASE WHEN (SELECT Total FROM Total_Customers) > 0 THEN (COUNT(DISTINCT C.CUSTOMER_NO) * 1.0 / (SELECT Total FROM Total_Customers)) * 100 ELSE 0 END AS Churn_Rate FROM CB_CUSTOMERS C INNER JOIN Dom_Closed_Accounts DCA ON C.CUSTOMER_NO = DCA.CUSTOMER_NUMBER LEFT JOIN Active_Accounts AA ON C.CUSTOMER_NO = AA.CUSTOMER_NUMBER LEFT JOIN Inactive_Accounts IA ON C.CUSTOMER_NO = IA.CUSTOMER_NUMBER LEFT JOIN Dormant_Accounts DA ON C.CUSTOMER_NO = DA.CUSTOMER_NUMBER WHERE AA.CUSTOMER_NUMBER IS NULL AND IA.CUSTOMER_NUMBER IS NULL AND DA.CUSTOMER_NUMBER IS NULL;"}]}
{"messages": [{"role":"system","content":"You are a MSSQL expert. Given an input question, create a syntactically correct SQL (MSSQL) query to run unless otherwise specified. Here is the relevant table info: {table_info}. Definitions: {definitions_string}. IMPORTANT: When generating SQL queries, make sure to apply the definitions provided above."},{"role":"user","content":"How many Domclosed customers do we have?"},{"role":"assistant","content":"WITH Dom_Closed_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -360, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -1800, GETDATE())), Active_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -90, GETDATE())) OR (CATEGORY LIKE '6%' AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -360, GETDATE()))), Inactive_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE (CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -90, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -180, GETDATE())) OR (CATEGORY LIKE '6%' AND LAST_TRANSACTION_DATE < DATEADD(DAY, -360, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -720, GETDATE()))), Dormant_Accounts AS (SELECT CUSTOMER_NUMBER FROM CB_ACCOUNTS WHERE CATEGORY LIKE '1%' AND CATEGORY NOT IN ('1080', '1031') AND LAST_TRANSACTION_DATE < DATEADD(DAY, -180, GETDATE()) AND LAST_TRANSACTION_DATE >= DATEADD(DAY, -360, GETDATE())) SELECT COUNT(DISTINCT C.CUSTOMER_NO) AS Dom_Closed_Customers FROM CB_CUSTOMERS C INNER JOIN Dom_Closed_Accounts DCA ON C.CUSTOMER_NO = DCA.CUSTOMER_NUMBER LEFT JOIN Active_Accounts AA ON C.CUSTOMER_NO = AA.CUSTOMER_NUMBER LEFT JOIN Inactive_Accounts IA ON C.CUSTOMER_NO = IA.CUSTOMER_NUMBER LEFT JOIN Dormant_Accounts DA ON C.CUSTOMER_NO = DA.CUSTOMER_NUMBER WHERE AA.CUSTOMER_NUMBER IS NULL AND IA.CUSTOMER_NUMBER IS NULL AND DA.CUSTOMER_NUMBER IS NULL;"}]}
